<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virmach 闪购监控</title>
</head>

<body>
    <h1 id=title>Virmach 闪购监控</h1>

    <div class=vpsContainer>
        <!-- vps 产品容器 -->
        <ul>
            <li>⌚️ 时间: <strong id="vpstime"></strong> -
            </li>

            <li><img alt="VIRTUALIZATION" src="3d.png" style="height:20px;width:20px"> 架构：<strong id="virt"></strong>
            </li>

            <li id="windows" style="display:none;"><img alt="WINDOWS" src="windows.png" style="height:20px;width:20px;"> 可用<strong>WINDOWS</strong>
            </li>

            <li><img alt="RAM" src="ram.png" style="height:20px;width:20px"> 内存：<strong id="ram"></strong> MB RAM
            </li>
            <li><img alt="CPU" src="cpu.png" style="height:20px;width:20px"> CPU：<strong id="cpu"></strong> vCORE
            </li>

            <li><img alt="HDD" src="disk.png" style="height:20px;width:20px"> 硬盘：<strong id="hdd"></strong> GB SSD (RAID 10)
            </li>

            <li><img alt="BANDWIDTH" src="network.png" style="height:20px;width:20px"> 流量：<strong id="bw"></strong> GB/月
            </li>

            <li>🧭 地点：<strong id="location"></strong>
            </li>

            <li>📍 IP数：<strong id="ips"></strong> DEDICATED IPv4
            </li>
            <li>💬 留言：<strong id="message"></strong>
            </li>
            <li>💰 价钱：<strong id="price"></strong>
            </li>

        </ul>
        <div id=isBuy style="display:none">
            <a id="buyurl " href="https://billing.virmach.com/aff.php&amp;pid=175&amp;billingcycle=annually ">购买</a>
        </div>
        <!-- <p class="center ">
            <a id="buyurl " href="https://billing.virmach.com/aff.php&amp;pid=175&amp;billingcycle=annually ">购买</a>
        </p> -->
    </div>

</body>

<script>
    // load JSON
    var requestURL = 'https://raw.githubusercontent.com/jsmjsm/virmach-monitor/main/virmach_json.json?token=ALZHSO7BFHGYMHKSBKUQV6K7YYMFW';
    // var requestURL = 'https://billing.virmach.com/modules/addons/blackfriday/new_plan.json';
    var request = new XMLHttpRequest();
    request.open('GET', requestURL);
    request.responseType = 'json';
    request.send();
    request.onload = function() {
        // handle the response json
        var vpsData = request.response;
        insertData(vpsData, 'virt', 'virt');
        insertData(vpsData, 'cpu', 'cpu');
        insertData(vpsData, 'ram', 'ram');
        insertData(vpsData, 'hdd', 'hdd');
        insertData(vpsData, 'bw', 'bw');
        insertData(vpsData, 'ips', 'ips');
        insertData(vpsData, 'location', 'location');
        insertData(vpsData, 'message', 'message');
        insertPrice(vpsData);
        isWinAvailable(vpsData);
        isBuyOk(vpsData);

    }

    // insertData
    function insertData(jsonObj, dataId, jsonKey) {
        var ramFather = document.getElementById(dataId);
        var td = document.createElement('td');
        td.textContent = jsonObj[jsonKey];
        ramFather.appendChild(td);
    }

    function insertPrice(jsonObj) {
        var ramFather = document.getElementById('price');
        var priceString = jsonObj['price'];
        var td = document.createElement('td');
        //   td.textContent = jsonObj[jsonKey];
        ramFather.appendChild(td);
        td.innerHTML = priceString;
    }

    function isWinAvailable(jsonObj) {
        var iwin = jsonObj['windows'];
        //var iwin = 'TRUE';
        bwin = document.getElementById('windows');
        if (iwin == "TRUE") {
            bwin.style.display = "block";
        } else {
            bwin.style.display = "none";
        }
    }

    function isBuyOk(jsonObj) {

        var jsonEnded = jsonObj['ended'];
        divBuy = document.getElementById('isBuy');
        jsonEnded = false;
        if (jsonEnded == true) {
            divBuy.style.display = "none";
        } else {
            divBuy.style.display = "block";
        }
    }
</script>


</html>